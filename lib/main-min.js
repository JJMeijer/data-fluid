"use strict";function DataFluid(){this.events=[],this.data={},this.set=function(a){this.typeCheck({object:a});var b=this.data;this.data=this.mergeObject(b,a)};var a={},b={};this.listen=function(b,c){var d=this;this.typeCheck({string:b,function:c}),a[b]=a[b]||[],a[b].push(c);var e=this.events.filter(function(a){return Object.keys(a)[0]===b});e.forEach(function(a){return d.trigger(b,a[b])})},this.once=function(a,c){var d=this;this.typeCheck({string:a,function:c}),b[a]=b[a]||[],b[a].push(c);var e=this.events.filter(function(b){return Object.keys(b)[0]===a});e.forEach(function(b,c){0===c&&d.trigger(a,b[a])})},this.trigger=function(c,d){this.typeCheck({string:c,object:d});var e={};e[c]=d,a[c]&&a[c].forEach(function(a){return a(e)}),b[c]&&(b[c].forEach(function(a){return a(e)}),b[c]=[]),this.events.push(e)}}Object.defineProperties(DataFluid.prototype,{getType:{value:function(a){if(null===a)return a+"";var b=/\[object (Boolean|Number|String|Function|Array|Date|RegExp)\]/,c=b.exec(Object.prototype.toString.call(Object(a)));return c?c[1].toLowerCase():"object"}},typeCheck:{value:function(a){var b=this;Object.keys(a).forEach(function(c){var d=b.getType(a[c]);if(d!==c)throw new Error("".concat(d," provided. Should be type ").concat(c))})}},clone:{value:function(a){return JSON.parse(JSON.stringify(a))}},isEmpty:{value:function(a){return"object"===this.getType(a)?"{}"===JSON.stringify(a):"array"===this.getType(a)?0===a.length:!("string"!==this.getType(a))&&0===a.length}},isData:{value:function(a){var b=/boolean|number|string|date|array|object/,c=b.exec(this.getType(a));return c&&!this.isEmpty(a)}},mergeObject:{value:function(a,b,c){var d=this,e=a;return Object.keys(b).forEach(function(a){var f=c?"".concat(c,".").concat(a):a,g=d.getType(e[a])===d.getType(b[a]);if(d.isData(b[a]))if("object"===d.getType(b[a])){var h=d.clone(e[a]),i=g?e[a]:{};e[a]=d.mergeObject(i,b[a],f),h!==e[a]&&d.trigger(f,d.clone(e[a]))}else if(Array.isArray(b[a])){var j=g?e[a]:[];e[a]=Array.prototype.concat.call(j,b[a]),d.trigger(f,d.clone(e[a]))}else{var k=e[a]!==b[a];e[a]=b[a],k&&d.trigger(f,b)}}),e}}}),window.dlTest=new DataFluid;
